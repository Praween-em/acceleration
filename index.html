
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Acceleration Simulation — Three.js</title>
<style>
  :root{
    --panel: rgba(10,10,10,0.8);
    --accent: #1e90ff;
    --bg: #eef7fb;
  }
  html,body{height:100%;margin:0;background:var(--bg);font-family:Inter,system-ui,Arial,sans-serif}
  #app {height:100%;display:flex;flex-direction:column}
  #topbar{
    display:flex;align-items:center;gap:12px;padding:10px;background:var(--panel);color:#fff;
    box-shadow:0 2px 8px rgba(0,0,0,0.2);
  }
  #title{font-weight:700}
  #container{flex:1;display:flex;flex-direction:row;gap:12px;padding:12px}
  #canvas-wrap{flex:1;background:#cfeffd;border-radius:10px;position:relative;overflow:hidden}
  #ui{
    width:380px;min-width:220px;max-width:420px;background:rgba(255,255,255,0.98);border-radius:10px;padding:12px;
    box-shadow:0 6px 18px rgba(0,0,0,0.12);display:flex;flex-direction:column;gap:10px;
    flex-shrink:1;
  }
  label{font-size:13px;color:#111}
  .row{display:flex;align-items:center;gap:10px}
  input[type=range]{flex:1}
  button{background:var(--accent);color:#fff;border:0;padding:8px 12px;border-radius:8px;cursor:pointer}
  button.secondary{background:#666}
  .small{font-size:13px;color:#222}
  .metrics{display:grid;grid-template-columns:repeat(2,1fr);gap:6px;padding:8px;background:#fff;border-radius:8px}
  .metric{background:#f7fafc;padding:8px;border-radius:6px;text-align:center;font-weight:600}
  /* responsive */
  @media (max-width:980px){
    #container{flex-direction:column}
    #ui{width:auto;max-width:none;font-size:14px}
    button{font-size:13px;padding:6px 10px}
  }
</style>
</head>
<body>
<div id="app">
  <div id="topbar">
    <div id="title">Acceleration: velocity & displacement demo</div>
    <div style="margin-left:auto" class="small">Model: s = s₀ + v₀t + ½at², v = v₀ + at</div>
  </div>

  <div id="container">
    <div id="canvas-wrap"></div>

    <div id="ui">
      <div style="display:flex;gap:8px">
        <button id="startBtn">Start</button>
        <button id="pauseBtn" class="secondary">Pause</button>
        <button id="stopBtn" class="secondary">Stop</button>
        <button id="resetBtn" class="secondary">Reset</button>
      </div>

      <div class="small">Initial velocity (v₀) m/s</div>
      <div class="row"><input id="v0" type="range" min="-10" max="10" step="0.5" value="2"><div id="v0Val" class="small" style="width:40px;text-align:right">2.0</div></div>

      <div class="small">Acceleration (a) m/s²</div>
      <div class="row"><input id="aVal" type="range" min="-6" max="6" step="0.25" value="1"><div id="aShow" class="small" style="width:40px;text-align:right">1.0</div></div>

      <div class="row">
        <label style="display:flex;align-items:center;gap:8px"><input id="follow" type="checkbox" checked> Follow cart</label>
        <label style="display:flex;align-items:center;gap:8px"><input id="vectors" type="checkbox" checked> Show vectors</label>
      </div>

      <div class="metrics" aria-live="polite">
        <div class="metric">Time (s)<div id="tVal">0.00</div></div>
        <div class="metric">Position s (m)<div id="sVal">0.00</div></div>
        <div class="metric">Velocity v (m/s)<div id="vVal">0.00</div></div>
        <div class="metric">Acceleration a (m/s²)<div id="aValDisp">1.00</div></div>
      </div>

      <div class="small" style="opacity:0.8">
        Explanation: Change v₀ and a, Start to see how velocity changes linearly with time and displacement follows quadratic growth.
      </div>
    </div>
  </div>
</div>

<!-- Three.js -->
<script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>

<script>
/* ---------- DOM ---------- */
const dom = {
  container: document.getElementById('canvas-wrap'),
  startBtn: document.getElementById('startBtn'),
  pauseBtn: document.getElementById('pauseBtn'),
  stopBtn: document.getElementById('stopBtn'),
  resetBtn: document.getElementById('resetBtn'),
  v0: document.getElementById('v0'),
  v0Val: document.getElementById('v0Val'),
  aRange: document.getElementById('aVal'),
  aShow: document.getElementById('aShow'),
  followBox: document.getElementById('follow'),
  vectorsBox: document.getElementById('vectors'),
  tVal: document.getElementById('tVal'),
  sVal: document.getElementById('sVal'),
  vVal: document.getElementById('vVal'),
  aValDisp: document.getElementById('aValDisp'),
};

let width = dom.container.clientWidth;
let height = dom.container.clientHeight;

/* ---------- Three.js scene ---------- */
const scene = new THREE.Scene();
scene.background = new THREE.Color(0xdfeff6);

const camera = new THREE.PerspectiveCamera(55, 1, 0.1, 2000);
const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: false });
renderer.setPixelRatio(window.devicePixelRatio || 1);
dom.container.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff, 0.7));
const sun = new THREE.DirectionalLight(0xffffff, 0.8);
sun.position.set(50, 80, 20);
scene.add(sun);

/* Track */
const TRACK_LENGTH = 120;
const ground = new THREE.Mesh(new THREE.PlaneGeometry(TRACK_LENGTH*1.2,20), new THREE.MeshStandardMaterial({ color: 0xe6f3f9 }));
ground.rotation.x = -Math.PI/2; scene.add(ground);

const track = new THREE.Mesh(new THREE.BoxGeometry(TRACK_LENGTH,0.15,6), new THREE.MeshStandardMaterial({ color: 0x424242 }));
track.position.y = 0.075; scene.add(track);

const startLine = new THREE.Mesh(new THREE.BoxGeometry(0.1,0.2,6.5), new THREE.MeshStandardMaterial({ color: 0xffffff }));
startLine.position.x = -TRACK_LENGTH/2 + 1; startLine.position.y = 0.2; scene.add(startLine);

/* ticks */
function makeTextSprite(message){
  const canvas = document.createElement('canvas');
  const context = canvas.getContext('2d');
  context.font = "24px Arial";
  const textWidth = context.measureText(message).width;
  canvas.width = textWidth + 20;
  canvas.height = 36;
  context.fillStyle = "rgba(255,255,255,0.9)";
  context.fillRect(0,0,canvas.width,canvas.height);
  context.fillStyle = "black";
  context.font = "24px Arial";
  context.fillText(message,10,24);
  const texture = new THREE.CanvasTexture(canvas);
  return new THREE.Sprite(new THREE.SpriteMaterial({map:texture}));
}
for(let i=0;i<=TRACK_LENGTH;i+=10){
  const tick = new THREE.Mesh(new THREE.BoxGeometry(0.05,0.15,0.6), new THREE.MeshStandardMaterial({ color: 0xffffff }));
  tick.position.x = -TRACK_LENGTH/2 + i; tick.position.y = 0.2; tick.position.z = 3.3; scene.add(tick);
  const label = makeTextSprite(i+'m'); label.position.set(tick.position.x,0.9,3.8); label.scale.set(0.8,0.4,1); scene.add(label);
}

/* cart */
function makeCart(){
  const group = new THREE.Group();
  const body = new THREE.Mesh(new THREE.BoxGeometry(4.5,1.6,2.4), new THREE.MeshStandardMaterial({ color: 0xff3333 }));
  body.position.y = 1.05; group.add(body);
  const wgeo = new THREE.CylinderGeometry(0.45,0.45,0.6,20);
  const wmat = new THREE.MeshStandardMaterial({ color: 0x111111 });
  const wheels = [];
  [[1.7,-1.1],[ -1.7,-1.1 ],[1.7,1.1],[-1.7,1.1]].forEach(pos=>{
    const w=new THREE.Mesh(wgeo,wmat); w.rotation.z=Math.PI/2; w.position.set(pos[0],0.45,pos[1]); group.add(w); wheels.push(w);
  });
  group.userData.wheels=wheels;
  return group;
}
const cart=makeCart(); scene.add(cart);

/* trail */
const trailGeometry=new THREE.BufferGeometry().setFromPoints([cart.position.clone()]);
const trail=new THREE.Line(trailGeometry,new THREE.LineBasicMaterial({color:0x00a3ff}));
scene.add(trail);
let trailPositions=[cart.position.clone()];

let velArrow=null, accArrow=null;
function updateArrows(){
  if(velArrow){scene.remove(velArrow);} if(accArrow){scene.remove(accArrow);}
  if(dom.vectorsBox.checked){
    velArrow=new THREE.ArrowHelper(new THREE.Vector3(1,0,0),cart.position.clone().add(new THREE.Vector3(0,1.4,0)),Math.max(0.2,Math.abs(state.v)*0.18),0x00a3ff);
    accArrow=new THREE.ArrowHelper(new THREE.Vector3(state.a>=0?1:-1,0,0),cart.position.clone().add(new THREE.Vector3(0,2.3,0)),Math.max(0.2,Math.abs(state.a)*0.6),0xffaa00);
    scene.add(velArrow); scene.add(accArrow);
  }
}

/* state */
const state={t:0,s:0,v:parseFloat(dom.v0.value),a:parseFloat(dom.aRange.value),running:false,lastFrame:null,boundaryReached:false};
const TRACK_START=0, TRACK_END=TRACK_LENGTH-3;

/* UI events */
dom.v0.addEventListener('input',()=>{state.v=parseFloat(dom.v0.value);dom.v0Val.textContent=state.v.toFixed(1);if(!state.running)dom.vVal.textContent=state.v.toFixed(2);});
dom.aRange.addEventListener('input',()=>{state.a=parseFloat(dom.aRange.value);dom.aShow.textContent=state.a.toFixed(2);dom.aValDisp.textContent=state.a.toFixed(2);});
dom.startBtn.addEventListener('click',()=>{if(!state.running&&!state.boundaryReached){state.running=true;state.lastFrame=performance.now();dom.startBtn.textContent='Running';}});
dom.pauseBtn.addEventListener('click',()=>{state.running=false;state.boundaryReached=false;dom.startBtn.textContent='Start';});
dom.stopBtn.addEventListener('click',()=>{state.running=false;state.boundaryReached=false;resetToStart();dom.startBtn.textContent='Start';});
dom.resetBtn.addEventListener('click',()=>{resetAll();dom.startBtn.textContent='Start';});

function resetToStart(){state.t=0;state.s=0;state.v=parseFloat(dom.v0.value);state.boundaryReached=false;trailPositions=[cart.position.clone()];trail.geometry.setFromPoints(trailPositions);updateCartTransform();updateUI();}
function resetAll(){state.t=0;state.s=0;state.v=parseFloat(dom.v0.value);state.a=parseFloat(dom.aRange.value);state.boundaryReached=false;trailPositions=[cart.position.clone()];trail.geometry.setFromPoints(trailPositions);updateCartTransform();updateUI();}
function sToX(s){return -TRACK_LENGTH/2+1+s;}
function updateCartTransform(){cart.position.x=sToX(state.s);cart.position.y=0;cart.position.z=0;if(cart.userData.wheels){cart.userData.wheels.forEach(w=>{w.rotation.x-=state.v*0.04;});}const last=trailPositions[trailPositions.length-1];const curr=cart.position.clone();if(!last||curr.distanceTo(last)>0.01){trailPositions.push(curr);if(trailPositions.length>1000)trailPositions.shift();trail.geometry.setFromPoints(trailPositions);}updateArrows();}
function updateUI(){dom.tVal.textContent=state.t.toFixed(2);dom.sVal.textContent=state.s.toFixed(2);dom.vVal.textContent=state.v.toFixed(2);dom.aValDisp.textContent=state.a.toFixed(2);}

camera.position.set(0,18,18);camera.lookAt(0,0,0);

function resizeRenderer(){const rect=dom.container.getBoundingClientRect();width=rect.width;height=rect.height;renderer.setSize(width,Math.max(height,200));camera.aspect=width/Math.max(height,200);camera.updateProjectionMatrix();}
window.addEventListener('resize',resizeRenderer);

function tick(now){requestAnimationFrame(tick);resizeRenderer();
  if(state.running&&!state.boundaryReached){
    const dt=Math.min((now-(state.lastFrame||now))/1000,0.05);state.lastFrame=now;
    state.s=state.s+state.v*dt+0.5*state.a*dt*dt;state.v=state.v+state.a*dt;state.t+=dt;
    if(state.s<TRACK_START){state.s=TRACK_START;state.v=0;state.running=false;state.boundaryReached=true;dom.startBtn.textContent='Start';}
    else if(state.s>TRACK_END){state.s=TRACK_END;state.v=0;state.running=false;state.boundaryReached=true;dom.startBtn.textContent='Start';}
    updateCartTransform();updateUI();
  }
  if(dom.followBox.checked){camera.position.lerp(new THREE.Vector3(cart.position.x,18,18),0.12);camera.lookAt(cart.position.x,0,0);}else{camera.position.lerp(new THREE.Vector3(0,18,18),0.12);camera.lookAt(0,0,0);}
  renderer.render(scene,camera);
}
resetAll();resizeRenderer();tick(performance.now());dom.vectorsBox.addEventListener('change',updateArrows);
</script>
</body>
</html>
